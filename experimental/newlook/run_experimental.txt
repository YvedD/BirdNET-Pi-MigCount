#!/usr/bin/env bash
set -e

# Move to repository root from experimental/newlook/
REPO_ROOT="$(cd "$(dirname "$0")/../.." && pwd)"
cd "$REPO_ROOT"

# Create/activate an isolated virtual environment
python3 -m venv .venv
source .venv/bin/activate

# Install and upgrade all sandbox dependencies on every start
pip install --upgrade pip
pip install --upgrade numpy scipy soundfile matplotlib streamlit pillow pyqtgraph PyQt6 datashader holoviews

# Sanity check imports
python - <<'EOF'
import numpy, scipy, soundfile, matplotlib, streamlit, pyqtgraph, PyQt6, datashader, holoviews  # noqa: F401
print("All experimental dependencies OK")
EOF

# Launch the sandbox GUI
python -m streamlit run experimental/newlook/app.py
echo "Open http://localhost:8501 in your browser to test the NewLook spectrogram GUI"
